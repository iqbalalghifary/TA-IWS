<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.19.0/font/bootstrap-icons.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.18.0/font/bootstrap-icons.css">
    <title>Reports Table</title>
    <style>
        .button-container {
          background-color: #f8f9fa;
        }

        body {
            padding: 20px;
        }

        .button-container {
            display: flex;
            justify-content: space-between;
            margin-bottom: 20px;
            align-items: center;
        }

        .pagination-container {
            display: flex;
            justify-content: flex-end;
            margin-top: 20px;
        }

        table {
            width: 100%;
            margin-top: 20px;
        }

        th, td {
            text-align: left;
        }

        th {
            cursor: pointer;
        }

        .pagination {
            display: flex;
        }

        .page-link {
            cursor: pointer;
        }
    </style>
</head>
<body>
  <div>
    <span class="label-text" style="font-size: 20px;"><strong>Cek Halaman Persetujuan</strong></span><br>
    <span class="subtitle-text">Lihat Sekarang : Pengecekan Terbaru <i class="fas fa-caret-down"></i></span>
  </div>
<br></br>
<div class="button-container">
    <a href="/input_file" class="btn btn-primary">
      Mulai Pengecekan <i class="bi bi-plus"></i>
    </a>
    
    <div class="pagination-container">
        <div class="pagination" id="pagination"></div>
    </div>
</div>

<table class="table table-hover" id="reportsTable">
    <thead>
        <tr>
            <th scope="col" onclick="sortTable(0)">No</th>
            <th scope="col" onclick="sortTable(1)">Title</th>
            <th scope="col" onclick="sortTable(2)">Status</th>
            <th scope="col" onclick="sortTable(4)">Waktu</th>
            <th scope="col">File</th>
        </tr>
    </thead>
    <tbody>
        {% for report in reports %}
        <tr>
            <th scope="row">{{ report.id }}</th>
            <td>{{ report.title }}</td>
            <td>{{ report.status }}</td>
            <td>{{ report.tanggal.strftime('%Y-%m-%d %H:%M') }}</td>
            <td>
                <a href="{{ report.file }}" target="_blank">
                    <img src="/static/icon/file-earmark-text.svg" alt="File Icon"> Download
                </a>
            </td>
        </tr>
        {% endfor %}
    </tbody>
</table>

<!-- Bootstrap JS and custom script for pagination and sorting -->
<script src="https://code.jquery.com/jquery-3.2.1.slim.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script>
    // Example function for sorting table by column index
    function sortTable(columnIndex) {
        var table, rows, switching, i, x, y, shouldSwitch;
        table = document.getElementById("reportsTable");
        switching = true;

        while (switching) {
            switching = false;
            rows = table.rows;

            for (i = 1; i < rows.length - 1; i++) {
                shouldSwitch = false;
                x = rows[i].getElementsByTagName("td")[columnIndex];
                y = rows[i + 1].getElementsByTagName("td")[columnIndex];

                if (x.innerHTML.toLowerCase() > y.innerHTML.toLowerCase()) {
                    shouldSwitch = true;
                    break;
                }
            }

            if (shouldSwitch) {
                rows[i].parentNode.insertBefore(rows[i + 1], rows[i]);
                switching = true;
            }
        }
    }

    // Example function for creating pagination
    function generatePagination(totalPages, currentPage) {
        var paginationContainer = document.getElementById("pagination");
        paginationContainer.innerHTML = "";

        for (var i = 1; i <= totalPages; i++) {
            var pageLink = document.createElement("a");
            pageLink.href = "#";
            pageLink.classList.add("page-link");
            pageLink.innerText = i;

            if (i === currentPage) {
                pageLink.classList.add("active");
            }

            pageLink.addEventListener("click", function (event) {
                event.preventDefault();
                // Implement logic to update the displayed page
                console.log("Go to page", i);
            });

            paginationContainer.appendChild(pageLink);
        }
    }

    generatePagination(5, 1);
</script>

</body>
</html>
